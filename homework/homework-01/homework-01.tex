\documentclass[10pt]{article}
% Math Packages
\usepackage{amsmath, mathtools}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{bbm}
\usepackage{breqn}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{calc}
\usepackage{forest}
\usepackage{tikz-qtree}
\graphicspath{ {./images/} }
\usepackage{hyperref}
\usepackage[capitalize]{cleveref}
\usepackage[shortlabels]{enumitem}
\usetikzlibrary{arrows,matrix,positioning}
\usepackage{multicol}

\usepackage{listings}
\usepackage{xcolor}

\lstset{
  language=R,
  basicstyle=\ttfamily\footnotesize,
  keywordstyle=\color{blue},
  commentstyle=\color{gray},
  stringstyle=\color{red!70!black},
  framesep=2pt,
  framexleftmargin=0pt, 
  frame=single,
  breaklines=false,
  showstringspaces=false
}
% for the pipe symbol
\usepackage[T1]{fontenc}

% Citing theorems by name. (source: https://tex.stackexchange.com/questions/109843/cleveref-and-named-theorems)
\makeatletter
\newcommand{\ncref}[1]{\cref{#1}\mynameref{#1}{\csname r@#1\endcsname}}

\def\mynameref#1#2{%
  \begingroup
  \edef\@mytxt{#2}%
  \edef\@mytst{\expandafter\@thirdoffive\@mytxt}%
  \ifx\@mytst\empty\else
  \space(\nameref{#1})\fi
  \endgroup
}
\makeatother

% Colorful Notes
\usepackage{color} \definecolor{Red}{rgb}{1,0,0} \definecolor{Blue}{rgb}{0,0,1}
\definecolor{Purple}{rgb}{.5,0,.5} \def\red{\color{Red}} \def\blue{\color{Blue}}
\def\gray{\color{gray}} \def\purple{\color{Purple}}
\newcommand{\rnote}[1]{{\red [#1]}} % \rnote{foo} gives '[foo]' in red
\newcommand{\pnote}[1]{{\purple [#1]}} % \pnote{foo} gives '[foo]' in purple
\newcommand{\bnote}[1]{{\blue #1}} % \bnote{foo} gives 'foo' in blue
\newcommand{\gnote}[1]{{\gray #1}} % \gnote{foo} gives 'foo' in gray
\newcommand{\Max}[1]{{\purple [#1]}} % \bnote{foo} then 'foo' is blue


% Claim numbering (the counter restarts after each proof environment)
\newcounter{claimcount}
\setcounter{claimcount}{0}
\newenvironment{claim}{\refstepcounter{claimcount}\par\addvspace{\medskipamount}\noindent\textbf{Claim \arabic{claimcount}:}}{}
\usepackage{etoolbox}
\AtBeginEnvironment{proof}{\setcounter{claimcount}{0}}
\newenvironment{claimproof}{\par\addvspace{\medskipamount}\noindent\textit{Proof of Claim  \arabic{claimcount}.}}{\hfill\ensuremath{\qedsymbol} \tiny{Claim}

  \medskip}
% Add claim support to cleverref
\crefname{claimcount}{Claim}{Claims}


% Math Environments
\newtheorem{theorem}{Theorem}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{question}[theorem]{Question}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{problem}[theorem]{Problem}

% Matrices and Column Vectors. 
\usepackage{stackengine}
\setstackgap{L}{1.0\normalbaselineskip}
\usepackage{tabstackengine}
\setstackEOL{;}% row separator
\setstackTAB{,}% column separator
\setstacktabbedgap{1ex}% inter-column gap
\setstackgap{L}{1.5\normalbaselineskip}% inter-row baselineskip
\let\nmatrix\bracketMatrixstack  %Usage: \nmatrix{1,2,3\4,5,6}
\newcommand\cv[1]{\setstackEOL{,}\bracketMatrixstack{#1}} %usage: \cv{1,2,3}

% Custom Math Coqmmands
\newcommand{\vt}{\vskip 5mm} % vertical space
\newcommand{\fl}{\noindent\textbf} % first line
\newcommand{\Fl}{\vt\noindent\textbf} % first line with space above
\newcommand{\norm}[1]{\left\lVert#1\right\rVert} % norm
\newcommand{\pnorm}[1]{\left\lVert#1\right\rVert_p} % p-norm
\newcommand{\qnorm}[1]{\left\lVert#1\right\rVert_q} % q-norm
\newcommand{\1}[1]{\textbf{1}_{\left[#1\right]}} % indicator function 
\def\limn{\lim_{n\to\infty}} % shortcut for lim as n-> infinity
\def\sumn{\sum_{n=1}^{\infty}} % shortcut for sum from n=1 to infinity
\def\sumkn{\sum_{k=1}^{n}} % shortcut for sum from k=1 to n
\def\sumin{\sum_{i=1}^{n}} % shortcut for sum from i=1 to n
\def\SAs{\sigma\text{-algebras}} % shortcut for $\sigma$-algebras
\def\SA{\sigma\text{-algebra}} % shortcut for $\sigma$-algebra
\def\Ft{\mathcal{F}_t} % time-indexed sigma-algebra (t)
\def\Fs{\mathcal{F}_s} % time-indexed sigma-algebra (s)
\def\F{\mathcal{F}} % sigma-algebra
\def\G{\mathcal{G}} % sigma-algebra
\def\R{\mathbb{R}} % Real numbers
\def\N{\mathbb{N}} % Natural numbers
\def\Z{\mathbb{Z}} % Integers
\def\E{\mathbb{E}} % Expectation
\def\P{\mathbb{P}} % Probability
\def\Q{\mathbb{Q}} % Q probability
\def\dist{\text{dist}} %Text 'dist' for things like 'dist(x,y)'
\newcommand{\indep}{\perp \!\!\! \perp}  %independence symbol
\def\Var{\mathrm{Var}} % Variance
\def\tr{\mathrm{tr}} % trace

% Brackets and Parentheses
\def\[{\left [}
    \def\]{\right ]}
% \def\({\left (}
%   \def\){\right )}



\usepackage{color}
\definecolor{Red}{rgb}{1,0,0}
\definecolor{Blue}{rgb}{0,0,1}
\definecolor{Purple}{rgb}{.5,0,.5}
\def\red{\color{Red}}
\def\blue{\color{Blue}}
\def\gray{\color{gray}}
\def\purple{\color{Purple}}
\definecolor{RoyalBlue}{cmyk}{1, 0.50, 0, 0}
\newcommand{\dempfcolor}[1]{{\color{RoyalBlue}#1}} 
\newcommand{\demph}[1]{\textcolor{RoyalBlue}{\textbf{\slshape #1}}} % Slanted

\usepackage{emoji}
% comment exactly one of the following line to show / hide the solutions
% \newcommand{\solution}[1]{{\purple #1}} % uncomment to show the solutions
\newcommand{\solution}[1]{} % uncomment to hide the solutions



\title{Math 472: Homework 01 \\Statistical Inference}
\date{Last updated: \today}
% \author{mh}

\begin{document}
\begin{center}
  \section*{Math 472: Homework 01} %
  \textit{Due Wednesday, Jan 21}
\end{center}

\Fl{Remark:} The problems in this homework are intended to either introduce you
to \texttt{R} or introduce/review some central concepts in probability that we
will need throughout this course. For the remainder of this course, any terms
defined using \demph{this format} are precise definitions and should be
memorized precisely (they are fair game for in-class quizzes after the homework
is due). Text in \textbf{bold} should be definitely reviewed if you are not
familiar with it.

\begin{problem}
  Install a bunch of software on your laptop:
  \begin{enumerate}[(a)]
    \item Install the statistical software \texttt{R}, available at the \url{https://cran.rstudio.com/}
    \item Install \texttt{RStudio Desktop}, available at
    \url{https://posit.co/download/rstudio-desktop/}. (If you already know
    \textrm{R} with a different IDE, you can skip this.)
    \item Do the \texttt{R} tutorial. (There are two optional exercises in this,
    but you don't have to turn anything in.)
    
    % \item DO \url{https://swcarpentry.github.io/shell-novice/} or
    % \url{https://carpentries-incubator.github.io/git-novice-branch-pr/} or \url{https://cecileane.github.io/computingtools/pages/notes0922-markdown.html}
    % \item Write an R function to generate and plot a 1 dimensional brownian motion
  \end{enumerate}
\end{problem}




\begin{problem}[Exercise 1.2 in the textbook]
  Are some cities more windy than others? Does Chicago deserve to be nicknamed
  `The Windy City'? Given below are the average wind speeds (in miles per
  hour) for 45 selected U.S. cities:

  
  \begin{equation*}
    \begin{array}{ccccccccc}
      8.9 & 7.1 & 9.1 & 8.8 & 10.2 & 12.4 & 11.8 & 10.9 & 12.7 \\
      10.3 & 8.6 & 10.7 & 10.3 & 8.4 & 7.7 & 11.3 & 7.6 & 9.6 \\
      7.8 & 10.6 & 9.2 & 9.1 & 7.8 & 5.7 & 8.3 & 8.8 & 9.2 \\
      11.5 & 10.5 & 8.8 & 35.1 & 8.2 & 9.3 & 10.5 & 9.5 & 6.2 \\
      9.0 & 7.9 & 9.6 & 8.8 & 7.0 & 8.7 & 8.8 & 8.9 & 9.4
    \end{array}
  \end{equation*}
  \begin{enumerate}[(a)]
    \item Use \textrm{R} to construct a relative frequency histogram for these
    data. (Play around with the number of breaks and find one that is
    reasonable).
    \item The value 35.1 was recorded at Mt. Washington, New Hampshire. Does
    the geography of that city explain the magnitude of its average wind
    speed?
    \item The average wind speed for Chicago is 10.3 miles per hour. What
    percentage of the cities have average wind speeds in excess of Chicago's?
    \item Do you think that Chicago is unusually windy?
  \end{enumerate}
\end{problem}



\begin{problem}
  A pair of events $A$ and $B$ cannot be simultaneously \textit{mutually
    exclusive} and \textit{independent}. Prove that if $P(A)>0$ and $P(B)>0$,
  then:
  \begin{enumerate}[(a)]
    \item If $A$ and $B$ are mutually exclusive, then they cannot be
    independent.
    \item If $A$ and $B$ are independent, then they cannot be mutually
    exclusive.
  \end{enumerate}
\end{problem}


\begin{problem}
  Let $\P$ be a probability measure and let $B$ be an event with
  $\P\left[B \right]>0$. Define the function $\P'$ by
  \begin{equation*}
    \P'\left[A \right]:= \P\left[A\mid B \right]
  \end{equation*}
  for every event $A$. Prove that $\P'$ is a probability measure.
\end{problem}


\begin{problem}[Exercise 1.20 in the textbook]
  Weekly maintenance costs for a factory, recorded over a long period of time
  and adjusted for inﬂation, tend to have an approximately normal distribution
  with an average of \$420 and a standard deviation of \$30. If \$450 is
  budgeted for next week, what is an approximate probability that this
  budgeted ﬁgure will be exceeded?
\end{problem}


\begin{problem}[This is essentially Example 2.1 in the textbook]
  A drone manufacturer has six seemingly-identical drones available for
  shipping. Unknown to her, two of the six have defective optics. A particular
  order calls for two drones and is filled by randomly selecting two of the six
  that are available.
  \begin{enumerate}[(a)]
    \item Label four good drones by $G_{1},G_{2},G_{3},G_{4}$ and the two
    defective drones by $B_{1}$ and $B_{2}$. List the sample space for this
    experiment.
    \item Let $A$ denote the event that the order is filled with two
    non-defective drones. List the sample points in $A$.
    \item Assign probabilities to each of the simple events in such a way that
    the information about the experiment is used (and such that the probability
    measure axioms are met).
    \item Find the probability of $A$.
    \item The following \texttt{R} code
    \begin{lstlisting}
      drones = c(1,1,1,1,0,0)
      sum(sample(drones,2,replace=FALSE))==2
    \end{lstlisting}
    represents the drones as 1's (nondefective) and 0's (defective), samples 2
    of them without replacement, and returns TRUE iff both drones are
    nondefective.

    Use the \texttt{R} function \texttt{replicate()} to repeat this experiment
    10,000 times and use your result to estimate the probability of $A$.

  \end{enumerate}
\end{problem}


\begin{problem}[Exercise 2.73 in the textbook]
  In 1865, the Austrian monk Gregor Mendel proposed a theory of inheritance
  which later became the foundation of modern genetics. In his experiments on
  flower color, Mendel studied heterozygous plants possesing two alleles:
  \begin{align*}
    \text{w} &=\text{ recessive white-color allele}\\
    \text{R} &=\text{ dominant red-color allele}.
  \end{align*}
  When two heterozygous plants were crossed, approximately $3/4$ of the
  offspring had red flowers and approximately $1/4$ had white flowers. The
  following table summarizes the possible allele combinations for the offspring;
  each parent contributes one allele, chosen at random, to the offspring:
  
  \begin{equation*}
    \begin{array}{c|cc}
      & \multicolumn{2}{c}{\textbf{Parent 1}} \\[-0.5ex]
      \textbf{Parent 2} & \text{w} & \text{R} \\ \hline
      \text{w} & \text{ww} & \text{wR} \\
      \text{R} & \text{wR} & \text{RR}
    \end{array}    
  \end{equation*}
  Assume each parent is equally likely to pass on either allele (w or R), and
  that the offspring has red flowers if and only if at least one of its alleles
  is dominant~(R), the offspring will have red ﬂowers. 
  \begin{enumerate}[(a)]
    \item What is the probability that an offspring has at least one dominant allele?
    \item What is the probability that an offspring has at least one recessive allele?
    \item Given that an offspring has red flowers, what is the probability that
    it has exactly one recessive allele?
  \end{enumerate}
\end{problem}


\begin{problem}[Exercise 2.86 in the textbook]
  Suppose that $A$ and $B$ are two events such that
  \begin{equation*}
    \P\left[A \right]=.8 \quad \text{and} \quad \P\left[B \right]=.7.
  \end{equation*}
  \begin{enumerate}[(a)]
    \item Is it possible that $\P\left[A\cap B \right]= .1$? Why or why not?
    \item What is the smallest possible value for $\P\left[A\cap B \right]$?
    \item Is it possible that $\P\left[A\cap B \right]=.77$? Why or why not?
    \item What is the largest possible value for $\P\left[A\cap B \right]$?
  \end{enumerate}
\end{problem}



\begin{problem}[The Law of Rare Events]
  A random variable $Y$ is said to have a \demph{Poisson probability
    distribution} with parameter $\lambda>0$, written
  $Y\sim \text{Pois}(\lambda)$ if its probability mass function is
  \begin{equation*}
    \P\left[Y=y \right] = \frac{\lambda^{y}}{y!}e^{-y}, \quad y \in  \left\{0,1,2,\ldots\right\}.
  \end{equation*}
  A random variable $X$ is said to be \demph{binomially distributed}, written
  $X\sim \text{Bin}(n,p)$, with parameters $n$ (called the ``size'' or
  ``number of trials'') and $p$ (the ``success probability'') if its
  probability mass function is
  \begin{equation*}
    \P\left[X=x \right] = {n\choose x} p^{x}(1-p)^{n-x}, \quad x\in \left\{0,1,2,\ldots,n\right\}.
  \end{equation*}
  \textit{[These are two important distributions; see Sections 3.4 and 3.8 in
    the textbook for good discussions of both.]} In this problem, we'll show how
  to approximate a binomial distribution with a Poisson distribution. (This
  approximation is sometimes called \textit{The Law of Rare Events}).

  \begin{enumerate}[(a)]
    \item \label{item:3} Show that for any $x\in \R$,
    \begin{equation*}
      \lim_{n\to\infty} \left( 1+\frac{x}{n} \right)^{n} = e^{x}.
    \end{equation*}
    \item \label{item:4} For fixed $\lambda>0$ and
    $k\in \left\{0,1,2,\ldots\right\}$, show that
    \begin{equation*}
      \lim_{n\to\infty} {n\choose k} \left( \frac{\lambda}{n} \right)^{k} = \frac{\lambda^{k}}{k!}.
    \end{equation*}
    \item \label{item:5} Fix $\lambda>0$ and $k\in \left\{0,1,2,\ldots\right\}$. Assume that
    $p=\lambda/n$ (which is getting smaller as $n \to \infty$). Use parts
    \ref{item:3} and \ref{item:4} to show that
    \begin{equation*}
      \P\left[Y=k \right] = \lim_{n\to\infty} \P\left[X=k \right]
    \end{equation*}
    \item In part \ref{item:5} you showed that if $n$ is large and $p$ is small
    (and $\lambda=np$ isn't too big), then a random variable
    $X\sim \text{Bin}(n,p)$ is well-approximated by the distribution Pois$(np)$.
    Let's apply this approximation to a real-world problem!

    In the popular role-playing game \textit{Dungeons \& Dragons}, a 20-sided
    dice is commonly rolled. When a `1' is rolled on the dice, that's called
    \textit{critical failure}, which usually results in something terrible
    happening. Suppose that in the course of a game, a 20-sided dice is rolled
    $n=100$ times. Let $X$ be the number of critical failures during the game.
    The probability of a critical failure is $p = 1/20 = .05$, so
  \begin{equation*}
    X\sim \text{Bin}(100,.05).
  \end{equation*}
  \begin{enumerate}[(i)]
    \item Suppose we wish to approximate $X$ with a
    $Y\sim \text{Pois}(\lambda)$. What would be a good value of $\lambda$?
    \item Using the \texttt{R} functions \texttt{rpois()} and \texttt{rbinom()},
    generate $100,000$ samples from the distributions of $X$ and $Y$, which
    you should save as vectors \texttt{X_samples} and \texttt{Y_samples} respectively.
    Then use the following code to plot two overlapping histograms:
    \begin{lstlisting}[resetmargins=false]
      hist(X_samples, probability=TRUE, breaks=20, col=rgb(1,0,0,0.4), border="red",
           main="Critical Failures: Binomial (X) vs Poisson (Y)",
           xlab="Number of critical failures in 100 rolls", xlim = c(0,20))
           
      hist(Y_samples, probability=TRUE, breaks=20, col=rgb(0,0,1,0.4), border="blue",
           add=TRUE)

      legend("topright", legend = c("approx. distribution of X",
             "approx. distribution of Y"), fill=c(rgb(1,0,0,0.4), rgb(0,0,1,0.4)))
    \end{lstlisting}
    \item Using your Poisson approximation, what is the approximate probability
    of 2 or fewer critical failures during the course of the game?
  \end{enumerate}
  \end{enumerate}
\end{problem}



% \begin{problem}
%   \begin{enumerate}[(a)]
%     Let $x\in \R$ be arbitrary.
%     \item Prove that 
%     \begin{equation*}
%       \lim_{n\to\infty} \left( 1+ \frac{x}{n} \right)^{n} = e^{x} 
%     \end{equation*}
%     \item Suppose that $(x_{n})$ is a sequence converging to $x$. Prove that
%     \begin{equation*}
%       \lim_{n\to\infty} \left( 1+\frac{x_{n}}{n} \right)^{n}=e^{x}. 
%     \end{equation*}
%   \end{enumerate}
% \end{problem}

\newpage
\begin{problem}
  An urn contains 5 balls, three red balls and two blue balls:
  \begin{center}
    \emoji{red-circle} \emoji{red-circle} \emoji{red-circle}
    \emoji{blue-circle} \emoji{blue-circle}
  \end{center}
  We consider the problem of sampling 3 balls from the urn, drawing the balls
  ``without replacement''. This means we draw one ball at random, then draw
  another ball at random, and then draw a third ball at random, without ever
  putting any of the balls back into the urn.

  For $k=1,2,$ and $3$, we will use the notation $R_{k}$ to denote the event
  that the $k^{\rm th}$ drawn ball is red, and $B_{k}$ to denote the event
  that the $k^{\rm th}$ drawn ball is blue. Obviously, $\P\left[R_{1}
  \right]=3/5$ and $\P\left[B_{1} \right]=2/5$.
  \begin{enumerate}[(a)]
    \item \label{item:1} Compute the conditional probabililities
    $\P\left[R_{2}\mid B_{1} \right]$ and $\P\left[R_{2}\mid R_{1} \right]$.
    \item Use the\textbf{ Law of Total Probability} (Theorem 2.8 in the textbook, p70)
    and your answer to part \ref{item:1} to compute $\P\left[R_{2} \right]$.
    \item \label{item:2} If $E$ and $F$ are events, we use the notation $EF$
    to denote the event that both $E$ and $F$ occur (i.e., $EF=E\cap F$).
    Compute the probabilities of the four events $R_{1}R_{2}$, $R_{1}B_{2}$,
    $B_{1}R_{2}$ and $B_{1}B_{2}$.
    \item Use the Law of Total Probability and your answer to part
    \ref{item:2} to compute $\P\left[R_{3} \right]$.
    \item In the remainder of this problem, we will compute the expected
    proportion of red balls among our 3 draws. To do this, we will introduce a
    standard technique: the use of indicator functions.

    Given an event $E$, the \demph{indicator function of $E$} is the function
    \begin{equation*}
      \mathbf{1}_{E} = \left\{ \begin{array}{l@{\quad:\quad}l} 1 & \text{the event }E
          \text{ occurs}\\ 0& \text{the event }E \text{ does not occur.} \end{array}\right.
    \end{equation*}
    Indicator functions are random variables. Taking $E=R_{k}$, we have
    \begin{equation*}
      \mathbf{1}_{R_{k}} = \left\{ \begin{array}{l@{\quad:\quad}l} 1 & \text{the }k^{\rm th}
          \text{ ball drawn is red}\\ 0& \text{the }k^{\rm th} \text{ ball drawn is blue.} \end{array}\right.
    \end{equation*}
    A random variable is \demph{discrete} if it can assume only a finite or
    countably infinite number of distinct values.

    % If $X$ is a random variable, the \demph{support} of $X$ is the smallest
    % closed set $S$ such that $\P\left[X\in S \right]=1$. We will denote the
    % support of $X$ either by $\text{supp}(X)$ or more commonly $S_{X}$.
    % Informally, the support of $X$ is the set of all possible values that it
    % can take.

    % A random variable $X$ is \demph{discrete} if $S_{X}$ is
    % countable.

    If $X$ is a discrete random variable, and $S_{X}\subseteq \R$ is the set
    of possible values that $X$ can take, then the \demph{expectation} of $X$,
    denoted $\E\left[X \right]$, is defined as
    \begin{equation*}
      \E\left[X \right]:= \sum_{x\in S_{X}}x \P\left[X=x \right],
    \end{equation*}
    \textit{provided that this sum converges absolutely}.

    
    Using the above definition of expectation, prove that
    $\E\left[\mathbf{1}_{R_{k}} \right]= \P\left[R_{k} \right]$ for $k=1,2,3$.
    \item Observe that
    \begin{equation*}
      (\#\text{ of red balls in 3 draws}) = \mathbf{1}_{R_{1}}+\mathbf{1}_{R_{2}}+\mathbf{1}_{R_{3}},
    \end{equation*}
    and hence
    \begin{equation}\label{eq:1}
      \text{(the proportion of red balls in 3 draws)} = \frac{\mathbf{1}_{R_{1}}+\mathbf{1}_{R_{2}}+\mathbf{1}_{R_{3}}}{3}
    \end{equation}
    The \textbf{linearity of expectation} says that if $X,Y$ are random
    variables, and $a,b$ are scalars, then
    $\E\left[X+Y \right]= \E\left[X \right]+ \E\left[Y \right]$, and
    $\E\left[aX+b \right]=a \E\left[X \right]+b$. Use the linearity of
    expectation and \cref{eq:1} to compute the expected proportion of red
    balls in 3 draws. \textit{(Note: if you've done all parts of this problem
      correct, you'll get 3/5.)}
    
  \end{enumerate}
\end{problem}


\end{document}